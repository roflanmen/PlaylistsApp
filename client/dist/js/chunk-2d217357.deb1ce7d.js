(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d217357"],{c66d:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e._self._c;return t("main",[t("h1",{staticClass:"page-title"},[e._v("Profile "),e.ownProfile?t("router-link",{attrs:{to:"/editprofile"}},[e._v("Edit ")]):e._e(),e.ownProfile||e.iAdmin?t("a",{attrs:{href:""},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.deleteUser.apply(null,arguments)}}},[e._v("Delete ")]):e._e(),e.ownProfile?t("a",{on:{click:function(t){e.creatingPlaylist=!0}}},[e._v("Create playlist")]):e._e()],1),t("div",{staticClass:"wrapper",attrs:{id:"wrapper"}},[e.creatingPlaylist?t("div",[t("form",{staticClass:"edit-form"},[t("p",[e._v("Playlist creation")]),t("label",{attrs:{for:"name"}},[e._v("Name:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"form-input",attrs:{type:"name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),t("br"),t("label",{attrs:{for:"isPublic"}},[e._v("Is public")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.isPublic,expression:"isPublic"}],staticClass:"form-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isPublic)?e._i(e.isPublic,null)>-1:e.isPublic},on:{change:function(t){var i=e.isPublic,s=t.target,a=!!s.checked;if(Array.isArray(i)){var r=null,o=e._i(i,r);s.checked?o<0&&(e.isPublic=i.concat([r])):o>-1&&(e.isPublic=i.slice(0,o).concat(i.slice(o+1)))}else e.isPublic=a}}}),t("br"),t("button",{staticClass:"form-button",attrs:{type:"submit"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.submit()}}},[e._v("Create")])])]):e._e(),t("p",[t("span",{staticClass:"username"},[e._v(e._s(e.role+" "+e.username))])]),t("h2",{staticClass:"block-name"},[e._v("Playlists:")]),e._l(e.playlists,(function(i){return t("router-link",{key:i.id,attrs:{to:"/playlist/"+i.id}},[t("p",[e._v(e._s(i.name))])])}))],2)])},a=[],r=(i("14d9"),{data(){return{role:"",username:"",playlists:[],id:null,ownProfile:!1,iAdmin:!1,creatingPlaylist:!1,name:"",isPublic:!1}},created(){this.refreshUser()},methods:{refreshUser(){let e="/api/user/";const t={};this.ownProfile=!0,this.$route.params.id&&(e+=this.$route.params.id,this.ownProfile=!1),localStorage.getItem("token")&&(t.headers={Authorization:"Bearer "+localStorage.getItem("token")}),fetch(e,t).then(e=>e.json()).then(e=>{if(e.message)return alert(e.message),void this.$router.push("/");this.id=e.id,this.username=e.username,this.role=e.is_admin?"Admin":"User",this.playlists=e.playlists}),localStorage.getItem("token")&&fetch("/api/user",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>e.json()).then(e=>{e.id===this.id&&(this.ownProfile=!0),this.iAdmin=e.is_admin})},deleteUser(){let e="/api/user/";this.$route.params.id&&(e+=this.$route.params.id),fetch(e,{method:"DELETE",headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>e.json()).then(e=>{"User deleted"===e.message?(void 0===this.$route.params.id&&(localStorage.removeItem("token"),this.$emit("logout")),this.$router.push("/")):alert(e.message)})},submit(){if(!this.name)return;const e={name:this.name,is_public:this.isPublic};fetch("/api/playlists/",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{e.message?alert(e.message):(this.creatingPlaylist=!1,this.refreshUser())})}},emits:["logout"]}),o=r,l=i("2877"),n=Object(l["a"])(o,s,a,!1,null,null,null);t["default"]=n.exports}}]);
//# sourceMappingURL=chunk-2d217357.deb1ce7d.js.map